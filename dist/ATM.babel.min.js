"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,t,o){return a.VALIDATE_RULES[e]?"function"==typeof a.VALIDATE_RULES[e]?a.VALIDATE_RULES[e](t,o):"object"===_typeof(a.VALIDATE_RULES[e])?(a.VALIDATE_RULES[e].requiredData=a.VALIDATE_RULES[e].requiredData||[],a.VALIDATE_RULES[e].requiredOptions=a.VALIDATE_RULES[e].requiredOptions||[],!a.VALIDATE_RULES[e].requiredData.some(function(e){return!t[e]&&console.warn("ATM validateData: Validate NOT passed, param: data."+e),!t[e]})&&!a.VALIDATE_RULES[e].requiredOptions.some(function(e){return!o[e]&&console.warn("ATM validateData: Validate NOT passed, param: options."+e),!o[e]})):(console.warn("ATM validateData: Type unmatched Please check your ATM_CONFIG.VALIDATE_RULES "),!0):(console.warn("ATM validateData: no matched validate rule, default return true"),!0)}var t={},a={VALIDATE_RULES:{piwik_emit:function(e,t){return!0},test:{requiredData:["test"],requiredOptions:[]},baidu_auto:{requiredData:[],requiredOptions:["trigger","page","element"]},google_auto:{requiredData:[],requiredOptions:["trigger","page","element"]},piwik_auto:{requiredData:[],requiredOptions:["trigger","page","element"]},default:{requiredData:[],requiredOptions:[]}},PROCESS_RULES:{piwik_emit:function(e,t){return!0},piwik_auto:[{mergeDataName:"category",mergeOptionName:"page"},{mergeDataName:"action",mergeOptionName:"trigger"},{mergeDataName:"name",mergeOptionName:"element"},{mergeDataName:"value",mergeOptionValue:1}]},REPORT_RULES:{piwik_auto:function(e,t){console.log("report piwik",e);var a=setInterval(function(){if("undefined"!=typeof Piwik)try{var t=Piwik.getTracker();e.value?t.trackEvent(e.category,e.action,e.name,e.value):t.trackEvent(e.category,e.action,e.name)}catch(e){console.log("piwik 尚未加载")}finally{clearInterval(a)}},200)},default:function(e,t){}}};t.autoCollectTrackData=function(t,a){if("object"===(void 0===t?"undefined":_typeof(t))&&t||(t={}),!(a&&a.trigger&&a.page&&a.element))return console.warn("ATM autoCollectTrackData: required options missed"),!1;if(a.validateRule&&!e(a.validateRule,t,a))return console.warn("ATM autoCollectTrackData: validateRule NOT passed"),!1;"*"===a.page&&(a.page=window.location.href.toLowerCase());var o=window.location.href.toLowerCase();try{if(-1!=o.indexOf(a.page)){var r=document.querySelectorAll(a.element);if(r){Array.prototype.slice.call(r).map(function(e){e.addEventListener(a.trigger,function(){console.log(this),console.log("ATM.emitCollectingTrackData(data,options)")})})}}}catch(e){console.log(e)}},t.emitCollectingTrackData=function(e,t){if(!e&&!t)return!1;t=t||{processType:"default"},t.processType||(t.processType="default"),t.reportType||(t.reportType="default"),console.log("emitCollectingTrackData",e,t),e=a.PROCESS_TYPE_MAPPING[t.processType]&&a.PROCESS_TYPE_MAPPING[t.processType](e,t),a.REPORT_TYPE_MAPPING[t.reportType]&&a.REPORT_TYPE_MAPPING[t.reportType](e,t)},t.setOptions=function(e){console.log("setOptions:"),console.log("options: "+e),console.log("ATM_CONFIG: "+a)},window.ATM=t}();
//# sourceMappingURL=ATM.babel.min.js.map
